##########################################
# Configuration de Linux (Mandrake 10.0) #
##########################################


###########################
# Driver forceware Nvidia #
###########################

Demarrer en mode console et lancer le sh  *.run. Pas de problème particulier.
Il faut d'abord verifier que kernel et kernel-source-2.6 sont installés et ont même numéro. 
Changer ensuite dans /etc/modprobe.conf
alias char-major-195* nvidia

Rajouter  dans /etc/modprobe.preload
nvidia

Changer Driver "nv" en "nvidia"
dans /etc/X11/XF86Config-4.
et décommenter glx

Pour configurer la sortie TV, mettre dans le /etc/X11/XF86Config-4 les lignes suivantes dans la section screen :

Option "TwinView"
Option "SecondMonitorHorizSync" "30-50"
Option "SecondMonitorVertRefresh" "60"
Option "Metamodes" "1152x864,1024x768;1024x768,1024x768;800x600,800x600;640x480,640x480"
Option "TwinViewOrientation" "Clone"

Pour le rafraichiisement rajouter 
# Resolution Personnelle 1152x864
ModeLine "1152x864" 147.18 1152 1200 1440 1536 864 866 878 904 #106Hz

Allez voir les sites
http://trustonme.net/didactels/?rub=127
http://koala.ilog.fr/cgi-bin/nph-colas-modelines-fr
pour plus d'informations.



##############
# XFConfig-4 #
##############


# File generated by XFdrake.

# **********************************************************************
# Refer to the XF86Config man page for details about the format of
# this file.
# **********************************************************************

Section "Files"
    # Multiple FontPath entries are allowed (they are concatenated together)
    # By default, Mandrake 6.0 and later now use a font server independent of
    # the X server to render fonts.
    FontPath "unix/:-1"
EndSection

Section "ServerFlags"
    #DontZap # disable <Crtl><Alt><BS> (server abort)
    AllowMouseOpenFail # allows the server to start up even if the mouse doesn't work
    #DontZoom # disable <Crtl><Alt><KP_+>/<KP_-> (resolution switching)
EndSection

Section "Module"
    Load "dbe" # Double-Buffering Extension
    Load "v4l" # Video for Linux
    Load "extmod"
    Load "type1"
    Load "freetype"
    Load "glx" # 3D layer
EndSection

Section "InputDevice"
    Identifier "Keyboard1"
    Driver "keyboard"
    Option "XkbModel" "pc105"
    Option "XkbLayout" "fr"
    Option "XkbOptions" ""
EndSection

Section "InputDevice"
    Identifier "Mouse1"
    Driver "mouse"
    Option "Protocol" "ExplorerPS/2"
    Option "Device" "/dev/mouse"
    Option "ZAxisMapping" "6 7"
EndSection

Section "Monitor"
    Identifier "monitor1"
    VendorName "Iiyama"
    ModelName "Iiyama S703HT, VisionMaster 403"
    HorizSync 27.0-96.0
    VertRefresh 50.0-160.0

    # 1152x864
    ModeLine "1152x864" 147.18 1152 1200 1440 1536 864 866 878 904 #106Hz

    # 1024x768
    ModeLine "1024x768" 134.24 1024 1072 1312 1408 768 770 782 808 #118Hz

    # 800x600
    ModeLine "800x600" 40.0 800 840 968 1056 600 601 605 628 +hsync +vsync  #60Hz
    
    # 640x480 
    Modeline "640x480" 25.175 640 664 760 800 480 491 493 525 #60Hz 
    
    # Sony Vaio C1(X,XS,VE,VN)?
    # 1024x480 @ 85.6 Hz, 48 kHz hsync
    #ModeLine "1024x480"    65.00 1024 1032 1176 1344   480  488  494  563 -hsync -vsync
    
    # Dell D800 and few Inspiron (16/10) 1280x800
    #ModeLine "1280x800"  147.89  1280 1376 1512 1744  800 801 804 848
    
    # Dell D800 and few Inspiron (16/10) 1680x1050
    #ModeLine "1680x1050"  214.51  1680 1800 1984 2288  1050 1051 1054 1103
    
    # Dell D800 and few Inspiron (16/10) 1920x1200
    #ModeLine "1920x1200" 230 1920 1936 2096 2528 1200 1201 1204 1250 +HSync +VSync
    
    # TV fullscreen mode or DVD fullscreen output.
    # 768x576 @ 79 Hz, 50 kHz hsync
    #ModeLine "768x576"     50.00  768  832  846 1000   576  590  595  630
    
    # 768x576 @ 100 Hz, 61.6 kHz hsync
    #ModeLine "768x576"     63.07  768  800  960 1024   576  578  590  616
EndSection

Section "Device"
    Identifier "device1"
    VendorName "nVidia"
    BoardName "NVIDIA GeForce4 (generic)"
    Driver "nvidia"
    Option "DPMS"
    BusID "3:0:0" 
    Option "NvAGP" "3"
    Option "DigitalVibrance" "0"
    Option "TransparentIndex" "0"
    Option "CursorShadowAlpha" "64"
    Option "CursorShadowXOffse" "4"
    Option "CursorShadowYOffset" "2"
    Option "Twinview" "true"
    Option "TwinViewOrientation" "Clone"
    Option "SecondMonitorHorizSync" "30-50"
    Option "SecondMonitorVertRefresh" "60"
    Option "MetaModes" "1152x864,NULL; 1024x768,NULL; 800x600,800x600; 640x480,640x480"
    #Option "ConnectedMonitor" "CRT,TV"
    Option "TVStandard" "PAL-N"

EndSection

Section "Screen"
    Identifier "screen1"
    Device "device1"
    Monitor "monitor1"
    DefaultColorDepth 24
   
    Subsection "Display"
        Depth 8
	Virtual 1152 864
    EndSubsection
    
    Subsection "Display"
        Depth 15
	Virtual 1152 864
    EndSubsection
    
    Subsection "Display"
        Depth 16
	Virtual 1152 864
    EndSubsection
    
    Subsection "Display"
        Depth 24
	Virtual 1152 864
    EndSubsection
EndSection

Section "ServerLayout"
    Identifier "layout1"
    InputDevice "Keyboard1" "CoreKeyboard"
    InputDevice "Mouse1" "CorePointer"
    Screen "screen1"
EndSection


########################
# Driver nforce Nvidia #
########################

Il faut d'abord verifier que kernel et kernel-source-2.6 sont installés et ont même numéro. 
Changer ensuite dans /etc/modprobe.conf
alias sound-slot-0 nvsound
alias eth0 nvnet

Il faut ensuite aller dans K -> Systeme -> Configuration -> KDE -> Son -> Systme son 
allez dans l'onglet Materiel puis mettre Open Thred.



##############################
# Configuration des fenêtres #
##############################

Mettre Keramik dans décoration des fenêtres
Mettre Plastik dans couleurs.
Mettre Keramik dans Style de KDE.


#################
# Configuration #
#################

Pour avoir la maximisation des fenêtres, aller dans configuration du bureau dans comportements des fenêtres.
Pour avoir le verrou numérique, faire configuration, kde, périphérique et clavier puis activer le clavier numérique.
Dans configuration, barre des tâches et grouper les mêmes tâches jamais.


##############
# Imprimante #
##############

Pour Canon i560 mettre BJC4100


#######################
# Script au démarrage #
#######################

Script demarrage comme un service :

Faire un lien symbolique ln ~/bin/sript.sh /etc/rc.5/S99aaa
pour qu'il soit démarrer lorsque X11 est lancé (faire avec rc.3 pour le mode console).


Script démarrage de kde :
mettre dans .kde/AutoStart

##############################
# Configuration /etc/inittab #
##############################

Configuration de l'initialisation

#
# inittab       This file describes how the INIT process should set up
#               the system in a certain run-level.
#
# Author:       Miquel van Smoorenburg, <miquels@drinkel.nl.mugnet.org>
#               Modified for RHS Linux by Marc Ewing and Donnie Barnes
#

# Default runlevel. The runlevels used by Mandrake Linux are:
#   0 - halt (Do NOT set initdefault to this)
#   1 - Single user mode
#   2 - Multiuser, without NFS (The same as 3, if you do not have networking)
#   3 - Full multiuser mode
#   4 - unused
#   5 - X11
#   6 - reboot (Do NOT set initdefault to this)
#
id:5:initdefault:

# System initialization.
si::sysinit:/etc/rc.d/rc.sysinit

l0:0:wait:/etc/rc.d/rc 0
l1:1:wait:/etc/rc.d/rc 1
l2:2:wait:/etc/rc.d/rc 2
l3:3:wait:/etc/rc.d/rc 3
l4:4:wait:/etc/rc.d/rc 4
l5:5:wait:/etc/rc.d/rc 5
l6:6:wait:/etc/rc.d/rc 6

# Trap CTRL-ALT-DELETE
ca::ctrlaltdel:/sbin/shutdown -t3 -r now

# When our UPS tells us power has failed, assume we have a few minutes
# of power left.  Schedule a shutdown for 2 minutes from now.
# This does, of course, assume you have powerd installed and your
# UPS connected and working correctly.
pf::powerfail:/sbin/shutdown -f -h +2 "Power Failure; System Shutting Down"

# If power was restored before the shutdown kicked in, cancel it.
pr:12345:powerokwait:/sbin/shutdown -c "Power Restored; Shutdown Cancelled"


# Run gettys in standard runlevels
1:2345:respawn:/sbin/mingetty tty1
2:2345:respawn:/sbin/mingetty tty2
3:2345:respawn:/sbin/mingetty tty3
4:2345:respawn:/sbin/mingetty tty4
5:2345:respawn:/sbin/mingetty tty5
6:2345:respawn:/sbin/mingetty tty6

# FaxGetty Entry
#t0:23:respawn:/usr/sbin/faxgetty ttyS0


#############################################
# Configuration des partitions : /etc/fstab #
#############################################

Configuration des mount

/dev/hda7 / ext3 defaults 1 1
none /dev/pts devpts mode=0620 0 0
/dev/hda9 /home ext3 defaults 1 2
/dev/hdc /mnt/cdrom auto umask=0,user,iocharset=iso8859-15,codepage=850,noauto,ro,exec,users 0 0
/dev/hdd /mnt/cdrom2 auto umask=0,user,iocharset=iso8859-15,codepage=850,noauto,ro,exec,users 0 0
none /mnt/floppy supermount dev=/dev/fd0,fs=ext2:vfat,--,umask=0,iocharset=iso8859-15,sync,codepage=850 0 0
/dev/hda1 /mnt/win_c vfat umask=0,iocharset=iso8859-15,codepage=850 0 0
/dev/hda6 /mnt/win_d vfat umask=0,iocharset=iso8859-15,codepage=850 0 0
none /proc proc defaults 0 0
/dev/hda8 /usr/local ext3 defaults 1 2
/dev/hda5 swap swap defaults 0 0



#########################
# Changer de résolution #
#########################

Faite CTRL + ALT + '+' ou '-'
et cela changera votre résolution suivant votre /etc/X11/XF86Config-4.


##########
# Xemacs #
##########

Pour gérer la molette de la souris, écrire dans le .xemacs 
(autoload 'mwheel-install "mwheel" "Enable mouse wheel support.")
(mwheel-install)


###########
# .bashrc #
###########

Exemple

# .bashrc

# User specific aliases and functions

# Source global definitions
if [ -f /etc/bashrc ]; then
	. /etc/bashrc
fi

# enable programmable completion features
if [ -f /etc/bash_completion ]; then
	. /etc/bash_completion
fi


# Prompt
PS1='\[\e[1;29m[\u@\h \w]\$\[\e[0m'

# Alias
alias rmf='rm -rf'
alias ecl='/usr/local/eclipse/eclipse -data ~/workspace -vmargs -ms512m -mx512m'



# D-béfinition de variable d'environnement

ANT_HOME=/usr/local/ant
CATALINA_HOME=/usr/local/tomcat
CATALINA_BASE=/usr/local/tomcat
JAVA_HOME=/usr/java/jdk
ECLIPSE_HOME=/usr/local/eclipse
JAVA_OPTS="-Xms512m -Xmx512m"
HOSTNAME="F2004"
MAVEN_HOME=/usr/local/maven
AZUREUS_HOME=/usr/local/azureus
APACHE_HOME=/usr/local/apache2
SUBVERSION_HOME=/usr/local/subversion
CVSROOT=/usr/local/cvsroot

LD_LIBRARY_PATH=/usr/local/lib:${SUBVERSION_HOME}/lib:${ECLIPSE_HOME}

PATH=${SUBVERSION_HOME}/bin:${APACHE_HOME}/bin:${MAVEN_HOME}/bin:${ANT_HOME}/bin:${CATALINA_HOME}/bin:${JAVA_HOME}/bin:${ECLIPSE_HOME}:~/bin:${AZUREUS_HOME}:${PATH}

# Export des variables
export USERNAME ENV PATH ANT_HOME CATALINA_HOME CATALINA_BASE JAVA_HOME ECLIPSE_HOME PS1 LD_LIBRARY_PATH JAVA_OPTS HOSTNAME MAVEN_HOME APACHE_HOME SUBVERSION_HOME CVSROOT


############
# Firewall #
############

Utiliser drakfirewall.
Rajouter les ports

21/udp 23/udp 25/udp 80/udp 110/udp 143/udp 443/udp 8080/tcp 6881:6899/tcp

Voir dans /etc/service à quoi cela correspond.



####################
# Supprimer les ^M #
####################

Ouvrez votre fichier avec vi (ou vim, gvim, ...).
Une fois le fichier ouvert, tapez :
:%s/<Ctrl-v><entrée>//g


##########################
# Carte Scsi Teckram 395 #
##########################

Rajouter dans /etc/modprobe.conf, /etc/modules.conf et /etc/ modules.conf.mdkgiorig

alias char-major-21 dc395x (21 vi de ls -l /dev/scsi/host0/ ... quand c'est chargé à la main)

et rajouter dans /etc/modprobe.preload et /etc/modules

dc395x


Pour pouvoir loader automatiquement au boot le module dc395x.
A la main faire, sous root faire modprobe dc395x 



########################
# Mise-à-jour Mandrake #
########################

Sous root :

urpmi.removemedia -a

urpmi.addmedia plf http://ftp.club-internet.fr/pub/linux/plf/mandrake/community with synthesis.hdlist.cz
urpmi.addmedia main ftp://ftp.proxad.net/pub/Distributions_Linux/Mandrakelinux/devel/community/i586/media/main with media_info/synthesis.hdlist.cz
urpmi.addmedia contrib ftp://ftp.proxad.net/pub/Distributions_Linux/Mandrakelinux/devel/community/i586/media/contrib with media_info/synthesis.hdlist.cz
urpmi.addmedia jpackage ftp://ftp.proxad.net/pub/Distributions_Linux/Mandrakelinux/devel/community/i586/media/jpackage with media_info/synthesis.hdlist.cz

urpmi.addmedia xdtv http://xawdecode.sourceforge.net/download/cvs.mdk.rpm with hdlist.cz 

urpmi.update -a 
urpmi --auto-select

Pour ajouter les medias 
(voir 
http://lea-linux.org/trucs/item.438.html et 
http://easyurpmi.zarb.org)

#######################
# Package interessant #
#######################

# Installation Python
urpmi wxPython
# (attention les dependances ne fonctionne pas toujours car il faudrait aller chercher sur la cooker)

# installation xemacs
urpme emacs
urpmi xemacs

# Bittorrent
urpmi bittorrent

# Amule
urpmi amule

# mozilla firefox et thundbird (voir sur cooker pour les dernieres versions)
urpmi mozilla-firefox
urpmi mozilla-thunderbird

# decompression
urpmi unrar
urpmi unace
urpmi unarj

# emulateur
urpmi zsnes
urpmi VisualBoy
urpmi gens
urpmi gxmame
urpmi TrueReality


# Rip
urpmi VideoRip

# Helixplayer
urpmi helixplayer
urpmi helixplayer-mozilla-plugin
urpmi helixplayer-helix-codecs
urpmi openquicktime
urpmi xanim-codecs

# wine
urpmi wine
urpmi xwine


# babytrans (Dictonaire)
urpmi babytrans

# Recette
urpmi gfaim

# myth logiciel pour la tv


# xdtv
urpmi xdtv xdtv-OSD-font xdtv-devel


# grisby (compta)
urpmi grisbi


# doxygen
urpmi doxygen

# namp et ethereal (scan reseau)
urpmi nmap
urpmi nmap-frontend
urpmi ethereal

# Scanner
urpmi xsane

# Rpm builder
urpmi rpm-build

# glib et gtk 2.4
urpmi glib2-devel
urpmi gtk2-devel

# d4x
urpmi d4x


# kernel et kernel-source-2.6 (verifier si c'est les meme version)
urpmi kernel
urpmi kernel-source-2.6


# Java
./jdk-1_5_0-linux-i586.rpm.bin
urpmi jdk-1_5_0-linux-i586.rpm
ln -s /usr/java/jdk1.5.0/jre/plugin/i386/ns7/libjavaplugin_oji.so /usr/lib/mozilla-firefox-0.10.1/plugins/


# Azureus, tomcat, maven, ant. eclipse (Dezipper)
